# Индексирование базы данных

Процесс создания специальной структуры данных, которая позволяет быстро находить нужные записи в базе данных.
Индексы могут быть созданы для отдельных полей или сочетаний полей в таблице базы данных.
Как правило, индексы упорядочивают записи в базе данных по определенному полю или полям,
что позволяет быстро находить нужные записи путем поиска в упорядоченном списке.
Индексы также могут улучшить производительность базы данных при выполнении
различных операций, таких как сортировка и группировка данных.


# AVERAGE (функция среднего)

Функция, которая вычисляет среднее значение выборки данных.
Она работает так: суммирует все значения в выборке и делит результат на количество значений.
Например, если у нас есть таблица с четырьмя строками и одним столбцом, содержащим числа `10`, `20`, `30` и `40`,
то среднее значение будет равно `25`.
Это можно посчитать, суммируя все числа `(10 + 20 + 30 + 40)`
и деля полученный результат `100` на количество чисел `4`, что даст `25`.


# Оконные функции

Функции баз данных, которые выполняют операции над наборами данных, называемыми "окнами".
Окна - это наборы строк в таблице, которые определяются каким-либо критерием
(например, временным интервалом, порядковым номером и т. д.).
Оконные функции позволяют совершать различные операции над этими наборами строк,
например, вычислять агрегатные функции (среднее, сумма, минимум и т. д.),
применять фильтры и группировки, выполнять ранжирование.
Оконные функции обычно используются с оператором `OVER`,
который определяет окно данных, над которыми будут выполняться операции.
Например, чтобы вычислить среднее значение поля `Зарплата` для каждой строки в таблице, можно использовать следующий запрос:

```sql
SELECT AVERAGE(Salary) OVER (PARTITION BY Department)
  FROM Employees;
```

В этом примере функция `AVERAGE` вычисляет среднее значение поля `Зарплата` для каждой группы строк


# PARTITION BY

Это часть оконных функций в базах данных, который используется для разбиения
набора строк на группы, называемые "партициями".Каждая партиция - это набор строк
с общими свойствами, определяемыми критерием, указанным в `PARTITION BY`
Может использоваться совместно с другими операторами,
такими как `ORDER BY` и `ROWS`/`RANGE`, чтобы определить окно данных более точно.
Например, чтобы вычислить среднее значение поля "Зарплата" для каждого отдела,
но учитывая только последние 3 месяца, можно использовать следующий запрос:

```sql
SELECT AVERAGE(Salary)
  OVER (
       PARTITION BY Department
       ORDER BY Month
       ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
  )
FROM Employees;
```

В этом примере функция `AVERAGE` будет вычислять среднее значение поля `Зарплата`
для каждой партиции (то есть для каждого отдела), учитывая только строки,
упорядоченные по полю `Месяц` и относящиеся к
последним 3 месяцам (включая текущий).


# PRECEDING

Это часть оконных функций в базах данных, который используется для определения окна данных
в терминах количества строк, находящихся до текущей строки.
Например, чтобы вычислить сумму последних 3 строк в таблице, можно использовать следующий запрос:

```sql
SELECT SUM(Value)
  OVER (
           ORDER BY Id
           ROWS BETWEEN 2
           PRECEDING AND CURRENT ROW
       )
  FROM Table;
```

В этом примере функция `SUM` будет вычислять сумму значений поля `Value` для каждой строки,
учитывая только строки, упорядоченные по полю `Id` и находящиеся до текущей строки на 2 строки (включая текущую).
Оператор `PRECEDING` может использоваться совместно с другими операторами, такими как `PARTITION BY` и `RANGE`,
чтобы определить окно данных более точно.
