Библиотека `collections` предоставляет специализированные контейнерные типы данных,
которые расширяют стандартные структуры, такие как списки, кортежи и словари.
Эти структуры данных помогают сделать код более читабельным и эффективным.

| Контейнер                          | Описание                                                                                                                               |
|------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------|
| `Counter`                          | Счетчик, который предназначен для подсчета хэшируемых объектов.<br>Возвращает словарь, где ключи — объекты, а значения — их количество |
| `defaultdict`                      | Словарь, который автоматически создает значение по умолчанию<br>для несуществующих ключей при первом обращении к ним                   |
| `OrderedDict`                      | Словарь, который сохраняет порядок добавления элементов                                                                                |
| `namedtuple()`                     | Создает подклассы кортежей с именованными полями,<br>что позволяет обращаться к элементам по имени                                     |
| `deque`                            | Двусторонняя очередь, которая поддерживает добавление<br>и удаление элементов с обоих концов с высокой производительностью             |
| `ChainMap`                         | Объединяет несколько словарей или других отображений в одно,<br>обеспечивая единый вид для поиска и изменения данных                   |
| `UserDict` `UserList` `UserString` | Классы для создания пользовательских словарей,<br>списков и строк с возможностью переопределения их поведения                          |

# Counter

Подкласс словаря, который предназначен для подсчета хэша объектов (например, слов, символов и т.д.).
Он подсчитывает количество вхождений каждого элемента.

| Функция/Метод                               | Описание                                                                                               | Пример                             |
|---------------------------------------------|--------------------------------------------------------------------------------------------------------|------------------------------------|
| `Counter()`                                 | Создает объект `Counter`                                                                               | `counter = Counter("abracadabra")` |
| `Counter().elements()`                      | Возвращает итератор по элементам, каждый из которых<br>повторяется столько раз, сколько он встречается | `list(counter.elements())`         |
| `Counter().most_common([n])`                | Возвращает n самых распространенных элементов и их количество                                          | `counter.most_common(2)`           |
| `Counter().subtract([iterable-or-mapping])` | Вычитает элементы, как и `update`, но уменьшает количество                                             | `counter.subtract("abcd")`         |
| `Counter().update([iterable-or-mapping])`   | Увеличивает счетчик для элементов из `iterable` или другого `Counter`                                  | `counter.update("abc")`            |


```python
from collections import Counter

counter = Counter("abracadabra")
print(counter)  # Counter({"a": 5, "b": 2, "r": 2, "c": 1, "d": 1})

# Выводим наиболее часто встречающиеся символы
print(counter.most_common(2))  # [("a", 5), ("b", 2)]
print(list(counter.elements()))  # ["a", "a", "a", "a", "a", "b", "b", "r", "r", "c", "d"]
```

# defaultdict

Подкласс словаря, который вызывает функцию для отсутствующих ключей и использует её результат в качестве значения по умолчанию.

| Функция/Метод                  | Описание                                 | Пример                 |
|--------------------------------|------------------------------------------|------------------------|
| `defaultdict(default_factory)` | Создает словарь с значением по умолчанию | `d = defaultdict(int)` |

```python
from collections import defaultdict

d = defaultdict(int)
d["a"] += 1
print(d)  # defaultdict(<class "int">, {"a": 1})
```

# OrderedDict

Подкласс словаря, который запоминает порядок добавления элементов.

| Функция/Метод                | Описание                                                | Пример                |
|------------------------------|---------------------------------------------------------|-----------------------|
| `OrderedDict()`              | Создает упорядоченный словарь                           | `od = OrderedDict()`  |
| `move_to_end(key, last=True)`| Перемещает элемент с заданным ключом в конец или начало | `od.move_to_end("a")` |
| `popitem(last=True)`         | Удаляет и возвращает элемент с конца или начала         | `od.popitem()`        |

```python
from collections import OrderedDict

od = OrderedDict()
od["a"] = 1
od["b"] = 2
od["c"] = 3
print(od)  # OrderedDict([("a", 1), ("b", 2), ("c", 3)])
```

# namedtuple

[Фабрика классов](?General/Design%20patterns%20(Паттерны%20проектирования)/Creational%20patterns%20(Порождающие%20паттерны)/Factory%20(Фабрика)), которая создает подклассы кортежа с именованными полями.

| Функция/Метод                       | Описание                                           | Пример                               |
|-------------------------------------|----------------------------------------------------|--------------------------------------|
| `namedtuple(typename, field_names)` | Создает новый тип кортежа с именами полей          | `Point = namedtuple("Point", "x y")` |
| `_replace(**kwargs)`                | Возвращает новый экземпляр, заменив указанные поля | `p._replace(x=10)`                   |

```python
from collections import namedtuple

Point = namedtuple("Point", ["x", "y"])
p = Point(10, 20)
print(p)    # Point(x=10, y=20)
print(p.x)  # 10
print(p.y)  # 20
```

# deque

Двусторонняя очередь, которая обеспечивает быстрый доступ и добавление элементов с обоих концов.

| Функция/Метод   | Описание                              | Пример             |
|-----------------|---------------------------------------|--------------------|
| `append(x)`     | Добавляет элемент в конец             | `dq.append(1)`     |
| `appendleft(x)` | Добавляет элемент в начало            | `dq.appendleft(1)` |
| `pop()`         | Удаляет и возвращает элемент с конца  | `dq.pop()`         |
| `popleft()`     | Удаляет и возвращает элемент с начала | `dq.popleft()`     |
| `rotate(n)`     | Вращает очередь на `n` шагов          | `dq.rotate(1)`     |

```python
from collections import deque

dq = deque([1, 2, 3])
dq.append(4)
dq.appendleft(0)
print(dq)  # deque([0, 1, 2, 3, 4])
dq.pop()
dq.popleft()
print(dq)  # deque([1, 2, 3])
```

# ChainMap

Объединяет несколько словарей или других отображений в одно логическое целое.

| Функция/Метод       | Описание                                                   | Пример                        |
|---------------------|------------------------------------------------------------|-------------------------------|
| `ChainMap(*maps)`   | Создает новый `ChainMap` из указанных отображений          | `cm = ChainMap(dict1, dict2)` |
| `new_child(m=None)` | Возвращает новый `ChainMap` с m как новой первичной картой | `cm.new_child({"c": 3})`      |

```python
from collections import ChainMap

d1 = {"a": 1, "b": 2}
d2 = {"b": 3, "c": 4}

d = ChainMap(d1, d2)
print(d)  # ChainMap({"a": 1, "b": 2}, {"b": 3, "c": 4})

print(d["a"])  # 1
print(d["b"])  # 2 (из d1, так как b в d1 появился раньше, чем в d2)
print(d["c"])  # 4 (из d2)

d3 = {"c": 5, "d": 6}
d = d.new_child(d3)

print(d["c"])  # 5 (из d3, так как он добавлен в цепочку позже, чем d2)
print(d["d"])  # 6 (из d3)
```

# UserDict, UserList, UserString

Эти классы предоставляют возможность создания пользовательских классов,
наследуемых от словаря, списка и строки соответственно, с возможностью переопределения их поведения.

| Класс        | Описание                                             | Пример                             |
|--------------|------------------------------------------------------|------------------------------------|
| `UserDict`   | Базовый класс для создания пользовательских словарей | `class MyDict(UserDict): pass`     |
| `UserList`   | Базовый класс для создания пользовательских списков  | `class MyList(UserList): pass`     |
| `UserString` | Базовый класс для создания пользовательских строк    | `class MyString(UserString): pass` |

```python
from collections import UserDict, UserList, UserString

d = UserDict({"a": 1, "b": 2})
d["c"] = 3
print(d)  # {"a": 1, "b": 2, "c": 3}

l = UserList([1, 2, 3])
l.append(4)
print(l)  # [1, 2, 3, 4]

s = UserString("hello, world")
print(s.upper())  # HELLO, WORLD


class MyDict(UserDict):
    def __setitem__(self, key, value):
        print(f"Setting {key} to {value}")
        super().__setitem__(key, value)


md = MyDict()
md["a"] = 1  # Setting a to 1
```

# Полезные ссылки
- [Официальная документация](https://docs.python.org/3/library/collections.html)
- [Real Python - Advanced Python Collections](https://realpython.com/python-collections-module/)
