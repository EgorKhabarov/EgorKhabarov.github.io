<pre><code class="language-python">import sqlite3
import csv

def SQL(Query, params=(), commit: bool = False):
    &quot;&quot;&quot;Выполняет SQL запрос&quot;&quot;&quot;
    with sqlite3.connect(r&quot;database.sqlite&quot;) as connection:
        cursor = connection.cursor()
        cursor.execute(Query, params)
        if commit: connection.commit()
        result = cursor.fetchall()
    return result

data = SQL(&quot;SELECT * FROM root;&quot;)

with open(&quot;data.csv&quot;, 'w', newline='', encoding='UTF-8') as file:
    writer = csv.writer(file)
    writer.writerow(['column 1', 'column 2', ...])
    writer.writerows(data)

with open('data.csv', 'r', encoding='UTF-8') as file:
    reader = csv.reader(file)
    headers = next(reader)
    SQL(f&quot;&quot;&quot;CREATE TABLE root ({', '.join([f&quot;{column} TEXT&quot; for column in headers])});&quot;&quot;&quot;, commit=True)
    for row in reader:
        SQL(f&quot;&quot;&quot;INSERT INTO root ({', '.join(headers)}) VALUES ({', '.join([f'&quot;{row}&quot;' for row in row])})&quot;&quot;&quot;, commit=True)
</code></pre>